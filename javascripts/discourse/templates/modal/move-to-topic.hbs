<DModalBody @id="choosing-topic">

  {{#if this.model.isPrivateMessage}}
    <div class="radios">
      {{#if this.canSplitToPM}}
        <label class="radio-label" for="move-to-new-message">
          <RadioButton @id="move-to-new-message" @name="move-to-entity" @value="new_message" @selection={{this.selection}} />
          <b>{{i18n "topic.move_to_new_message.radio_label"}}</b>
        </label>
      {{/if}}

      <label class="radio-label" for="move-to-existing-message">
        <RadioButton @id="move-to-existing-message" @name="move-to-entity" @value="existing_message" @selection={{this.selection}} />
        <b>{{i18n "topic.move_to_existing_message.radio_label"}}</b>
      </label>
    </div>

    {{#if this.canSplitTopic}}
      {{#if this.newMessage}}
        <p>{{html-safe (i18n "topic.move_to_new_message.instructions" count=this.selectedPostsCount)}}</p>
        <form>
          <label>{{i18n "topic.move_to_new_message.message_title"}}</label>
          <TextField @value={{this.topicName}} @placeholderKey="composer.title_placeholder" @id="split-topic-name" />

          {{#if this.canTagMessages}}
            <label>{{i18n "tagging.tags"}}</label>
            <TagChooser @tags={{this.tags}} />
          {{/if}}
        </form>
      {{/if}}
    {{/if}}

    {{#if this.existingMessage}}
      <p>{{html-safe (i18n "topic.move_to_existing_message.instructions" count=this.selectedPostsCount)}}</p>
      <form>
        <ChooseMessage @currentTopicId={{this.model.id}} @selectedTopicId={{this.selectedTopicId}} />

        <label>{{i18n "topic.move_to_new_message.participants"}}</label>
        <EmailGroupUserChooser @class="participant-selector" @value={{this.participants}} @onChange={{action (mut this.participants)}} />
      </form>
    {{/if}}

  {{else}}

    <div class="radios">
      {{#if this.canSplitTopic}}
        <label class="radio-label" for="move-to-new-topic">
          <RadioButton @id="move-to-new-topic" @name="move-to-entity" @value="new_topic" @selection={{this.selection}} />
          <b>{{i18n "topic.split_topic.radio_label"}}</b>
        </label>
      {{/if}}

      <label class="radio-label" for="move-to-existing-topic">
        <RadioButton @id="move-to-existing-topic" @name="move-to-entity" @value="existing_topic" @selection={{this.selection}} />
        <b>{{i18n "topic.merge_topic.radio_label"}}</b>
      </label>

      {{#if this.canSplitToPM}}
        <label class="radio-label" for="move-to-new-message">
          <RadioButton @id="move-to-new-message" @name="move-to-entity" @value="new_message" @selection={{this.selection}} />
          <b>{{i18n "topic.move_to_new_message.radio_label"}}</b>
        </label>
      {{/if}}
    </div>

    {{#if this.existingTopic}}
      <p>{{html-safe (i18n "topic.merge_topic.instructions" count=this.selectedPostsCount)}}</p>
      <form>
        <ChooseTopic @currentTopicId={{this.model.id}} @selectedTopicId={{this.selectedTopicId}} />
      </form>
    {{/if}}

    {{#if this.canSplitTopic}}
      {{#if this.newTopic}}
        <p>{{html-safe (i18n "topic.split_topic.instructions" count=this.selectedPostsCount)}}</p>
        <form>
          <label>{{i18n "topic.split_topic.topic_name"}}</label>
          <TextField @value={{this.topicName}} @placeholderKey="composer.title_placeholder" @id="split-topic-name" />

          <label>{{i18n "categories.category"}}</label>
          <CategoryChooser @value={{this.categoryId}} @class="small" @onChange={{action (mut this.categoryId)}} />
          {{#if this.canAddTags}}
            <label>{{i18n "tagging.tags"}}</label>
            <TagChooser @tags={{this.tags}} @categoryId={{this.categoryId}} />
          {{/if}}
        </form>
      {{/if}}
    {{/if}}

    {{#if this.canSplitTopic}}
      {{#if this.newMessage}}
        <p>{{html-safe (i18n "topic.move_to_new_message.instructions" count=this.selectedPostsCount)}}</p>
        <form>
          <label>{{i18n "topic.move_to_new_message.message_title"}}</label>
          <TextField @value={{this.topicName}} @placeholderKey="composer.title_placeholder" @id="split-topic-name" />

          {{#if this.canTagMessages}}
            <label>{{i18n "tagging.tags"}}</label>
            <TagChooser @tags={{this.tags}} />
          {{/if}}
        </form>
      {{/if}}
    {{/if}}
  {{/if}}

</DModalBody>

<div class="modal-footer">
  <DButton @class="btn-primary" @disabled={{this.buttonDisabled}} @action={{action "performMove"}} @icon="sign-out-alt" @translatedLabel={{this.buttonTitle}} />
</div>
